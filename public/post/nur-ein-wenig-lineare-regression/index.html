<!DOCTYPE html>
<html lang="de-de">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.32.3" />
  <meta name="author" content="Norman Markgraf">
  <meta name="description" content="Diplom-Mathematiker">

  
  <link rel="alternate" hreflang="de-de" href="/nab/post/nur-ein-wenig-lineare-regression/">

  
  


  

  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/nab/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-111285016-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="/nab/index.xml" type="application/rss+xml" title="Normans Akademischer Blog">
  <link rel="feed" href="/nab/index.xml" type="application/rss+xml" title="Normans Akademischer Blog">
  

  <link rel="manifest" href="/nab/site.webmanifest">
  <link rel="icon" type="image/png" href="/nab/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/nab/img/icon-192.png">

  <link rel="canonical" href="/nab/post/nur-ein-wenig-lineare-regression/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@NormanMarkgraf">
  <meta property="twitter:creator" content="@NormanMarkgraf">
  
  <meta property="og:site_name" content="Normans Akademischer Blog">
  <meta property="og:url" content="/nab/post/nur-ein-wenig-lineare-regression/">
  <meta property="og:title" content="Nur ein wenig lineare Regression | Normans Akademischer Blog">
  <meta property="og:description" content="">
  <meta property="og:locale" content="de-de">
  
  <meta property="article:published_time" content="2018-01-08T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-01-08T00:00:00&#43;00:00">
  

  

  <title>Nur ein wenig lineare Regression | Normans Akademischer Blog</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Zur Navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/nab/">Normans Akademischer Blog</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="/nab/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/nab/#posts">
            
            <span>Blog</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/nab/#projects">
            
            <span>Projekte</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/nab/#teaching">
            
            <span>Lehre</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/nab/#contact">
            
            <span>Impressum</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">Nur ein wenig lineare Regression</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-01-08 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Mon, 8. Jan. 2018
    </time>
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    11 
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/nab/post/nur-ein-wenig-lineare-regression/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/nab/categories/statistik">Statistik</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Nur%20ein%20wenig%20lineare%20Regression&amp;url=%2fnab%2fpost%2fnur-ein-wenig-lineare-regression%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fnab%2fpost%2fnur-ein-wenig-lineare-regression%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fnab%2fpost%2fnur-ein-wenig-lineare-regression%2f&amp;title=Nur%20ein%20wenig%20lineare%20Regression"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fnab%2fpost%2fnur-ein-wenig-lineare-regression%2f&amp;title=Nur%20ein%20wenig%20lineare%20Regression"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Nur%20ein%20wenig%20lineare%20Regression&amp;body=%2fnab%2fpost%2fnur-ein-wenig-lineare-regression%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        <p>Der <em>tipping</em> Datensatz wird oft analysiert. Das Verhältnis von Trinkgeld (<em>tip</em>) und Rechnungsbetrag (<em>total_bill</em>) steht dabei im Vordergrund einer lineare Regressionsanalyse. So auch hier. Wir wollen die einzelnen Angaben von <strong>R</strong> dabei in den Fokus rücken und einmal Hinterfragen, was wir bei der Ausgabe von <strong>R</strong> eigentlich genau sehen, woher es kommt und wie man es interprätieren kann.</p>
<p>Zunächt laden wir dazu die <strong>tipping</strong> Daten mittels</p>
<pre class="r"><code>library(mosaic)
download.file(&quot;https://goo.gl/whKjnl&quot;, destfile = &quot;tips.csv&quot;)
tips &lt;- read.csv2(&quot;tips.csv&quot;)</code></pre>
<p>in den Arbeitsspeicher.</p>
<p>Eine lineares Modell wird schnell mit</p>
<pre class="r"><code>linMod &lt;- lm(tip ~ total_bill, data = tips)</code></pre>
<p>erstellt. Betrachten wir nun die Zusammenfassung:</p>
<pre class="r"><code>summary(linMod)</code></pre>
<pre><code>## 
## Call:
## lm(formula = tip ~ total_bill, data = tips)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.1982 -0.5652 -0.0974  0.4863  3.7434 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.920270   0.159735   5.761 2.53e-08 ***
## total_bill  0.105025   0.007365  14.260  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.022 on 242 degrees of freedom
## Multiple R-squared:  0.4566, Adjusted R-squared:  0.4544 
## F-statistic: 203.4 on 1 and 242 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Die zentrale Frage bei einer linearen Regression ist, finden wir einen linearen Zusammenhang in unserer Stichprobe, den wir auf die Population (als die Grundgesamtheit) übertragen können.</p>
<p>Die Spalte <strong>Estimate</strong> im Abschnitt <strong>Coefficients</strong> liefert uns in unser Stichprobe einen möglichen linearen Zusammenhang gemäß</p>
<p><span class="math display">\[\hat{y}_{\text{tip}} = \hat{\beta}_{\text{0}} + \hat{\beta}_{\text{total_bill}} \cdot x_{\text{total_bill}},\]</span></p>
<p>mit den <em>Regressionskoeffizienten</em> <span class="math inline">\(\hat{\beta}_0=0.9202696\)</span> und <span class="math inline">\(\hat{\beta}_{\text{total_bill}}=0.1050245\)</span>.</p>
<p>Graphisch ergibt sich damit das Modell wie folgt:</p>
<pre class="r"><code># Statt plotModel(linMod) besser:
library(lattice)
mypanel &lt;- function(x, y) {
    # Scatterplot:
    panel.xyplot(x, y, col = &quot;darkgreen&quot;)
    # Regressionsgerade:
    panel.abline(linMod, col = &quot;red&quot;, lwd = 1.2, lty = 2)
}
xyplot(tip ~ total_bill, data = tips, panel = mypanel, main = &quot;Streudiagramm der Trinkgelder&quot;, 
    ylab = &quot;Trinkgeld&quot;, xlab = &quot;Rechnungsbetrag&quot;, key = list(space = &quot;bottom&quot;, 
        padding.text = 8, lines = list(col = c(&quot;red&quot;), lty = c(2), 
            lwd = 1.2), text = list(c(&quot;Regressionsgerade&quot;))))</code></pre>
<p><img src="/nab/post/2018-01-08-nur-ein-wenig-lineare-regression_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Was hat es nun mit dem y-Achenabschnitt <span class="math inline">\(\hat{\beta}_0\)</span> aufsich?</p>
<p>Ist es etwa eine Art <em>Grundtrinkgeld</em>, mit dem der Kellern rechnen kann, auch wenn der Kunde gar nichts bestellt?</p>
<p>Nun ja, es so etwas in der Art, aber eben ein rein fiktiver Wert, der durch die Konstruktion der Parameter entsteht. Eine (affin-)lineare Gerade geht nun einmal irgendwann durch die y-Achse (wenn sie nicht parallel dazu ist) und es kann passieren, dass eine sinnvolle Interpretation nicht so ohne weiteres möglich ist.</p>
<p>Wir können aber dieses <em>Grundtrinkgeld</em> herraus nehmen und den y-Achenabschnitt auf Null setzen. Dazu ziehen wir <span class="math inline">\(\hat{\beta}_0\)</span> einfach von alle Trinkgeldern ab. Wir erhalten quasi nur noch den <em>Trinkgeldzuwach</em>.</p>
<pre class="r"><code>beta_0 &lt;- coef(linMod)[&quot;(Intercept)&quot;]  # Grundtrinkgeld
tips$delta_tip &lt;- tips$tip - beta_0  # wird abgezogen</code></pre>
<p>Vergleichen wir das alte lineare Modell mit dem neuen Modell (<em>linModDelta</em>):</p>
<pre class="r"><code>linModDelta &lt;- lm(delta_tip ~ total_bill, data = tips)
summary(linModDelta)</code></pre>
<pre><code>## 
## Call:
## lm(formula = delta_tip ~ total_bill, data = tips)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.1982 -0.5652 -0.0974  0.4863  3.7434 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -4.549e-15  1.597e-01    0.00        1    
## total_bill   1.050e-01  7.365e-03   14.26   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.022 on 242 degrees of freedom
## Multiple R-squared:  0.4566, Adjusted R-squared:  0.4544 
## F-statistic: 203.4 on 1 and 242 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>In diesem Modell ist der Wert für den y-Achenabschnitt numerisch gleich 0. – Ja, da mag zwar <span class="math inline">\(-4.5487837\times 10^{-15}\)</span> stehen, jedoch sind so kleine Werte der jedem Rechner inne wohnenden Ungenauigkeit in der Gleitkomma-Arithmetik geschuldet und wind faktisch gleich 0.</p>
<p>Der Wert für die Steigung lautet weiterhin <span class="math inline">\(0.1050245\)</span>. Das war auch zu erwarten, denn wir haben unsere Regressionsgerade eigentlich nur um <span class="math inline">\(\hat{\beta}_0\)</span> nach unten verschoben. (Der Fachmann spricht von einer Translation (Parallelverschiebung)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> um <span class="math inline">\(-\hat{\beta}_0\)</span>.</p>
<pre class="r"><code># Statt plotModel(linModDelta) besser:
library(lattice)
mypanel &lt;- function(x, y) {
    # Scatterplot:
    panel.xyplot(x, y, col = &quot;darkgreen&quot;)
    # Regressionsgerade:
    panel.abline(linModDelta, col = &quot;red&quot;, lwd = 1.2, lty = 2)
}
xyplot(delta_tip ~ total_bill, data = tips, panel = mypanel, 
    main = &quot;Streudiagramm der Delta Trinkgelder&quot;, ylab = &quot;Delta Trinkgeld&quot;, 
    xlab = &quot;Rechnungsbetrag&quot;, key = list(space = &quot;bottom&quot;, padding.text = 8, 
        lines = list(col = c(&quot;red&quot;), lty = c(2), lwd = 1.2), 
        text = list(c(&quot;Regressionsgerade&quot;))))</code></pre>
<p><img src="/nab/post/2018-01-08-nur-ein-wenig-lineare-regression_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Vergleichen wir die beiden Zusammenfassungen, so stellen wir fest das sich mit Aussnahme der <em>[Intercept]</em> Zeile parktisch nichts geändert hat. Das ist kein Wunder, sondern Absicht!</p>
<p>Die Regressionsgerade stellt für unsere Stichprobe die Gerade mit dem geringsten Fehler an den Datenpunkten dar. Mathematisch heißt das folgendes:</p>
<p>An den <span class="math inline">\(n=244\)</span> Datenpunkten unserer Stichprobe <span class="math inline">\((x_i, y_i)=(tips\$total\_bill[i], tips\$tip[i])\)</span> [für (i=1,,n)$] sind die <em>Residuen</em>, also die <em>Fehlerterme</em>,</p>
<p><span class="math display">\[
 \hat{e}_i =\hat{y}_i - y_i = \left[\hat{\beta}_{\text{0}} + \hat{\beta}_{\text{total_bill}} \cdot x_i\right] - y_i
\]</span></p>
<p>durch die verwendete <em>Methode der kleinsten Quadrate</em><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> <em>quadratisch minimal</em>. Kurz:</p>
<p><span class="math display">\[
    \sum_{i=1}^n (\hat{e}_i)^2 \text{ ist minimal!}
\]</span></p>
<p>Wir können uns nun diese Fehlerterme auch graphisch Ansehen um die Varianz der Residuen zu sehen. Dazu siehen wir von allen Datenpunkt <span class="math inline">\(y_i\)</span> den geschätzen Wert <span class="math inline">\(\hat{y}_i\)</span> ab und erstellen ein neues lineares Modell</p>
<pre class="r"><code>beta_total_bill &lt;- coef(linModDelta)[&quot;total_bill&quot;]
tips$error_tip &lt;- (tips$tip - beta_0 - beta_total_bill * tips$total_bill)
linModError &lt;- lm(error_tip ~ total_bill, data = tips)
summary(linModError)</code></pre>
<pre><code>## 
## Call:
## lm(formula = error_tip ~ total_bill, data = tips)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.1982 -0.5652 -0.0974  0.4863  3.7434 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  1.900e-15  1.597e-01       0        1
## total_bill  -8.740e-17  7.365e-03       0        1
## 
## Residual standard error: 1.022 on 242 degrees of freedom
## Multiple R-squared:  6.665e-31,  Adjusted R-squared:  -0.004132 
## F-statistic: 1.613e-28 on 1 and 242 DF,  p-value: 1</code></pre>
<pre class="r"><code># Statt plotModel(linModError) besser:
library(lattice)
mypanel &lt;- function(x, y) {
    # Scatterplot:
    panel.xyplot(x, y, col = &quot;darkgreen&quot;)
    # Regressionsgerade:
    panel.abline(linModError, col = &quot;red&quot;, lwd = 1.2, lty = 2)
}
xyplot(error_tip ~ total_bill, data = tips, panel = mypanel, 
    main = &quot;Streudiagramm der Residuen&quot;, ylab = &quot;Residuen&quot;, xlab = &quot;Rechnungsbetrag&quot;, 
    key = list(space = &quot;bottom&quot;, rows = 3, padding.text = 8, 
        lines = list(col = c(&quot;red&quot;), lty = c(2), lwd = 1.2), 
        text = list(c(&quot;Regressionsgerade / x-Achse&quot;))))</code></pre>
<p><img src="/nab/post/2018-01-08-nur-ein-wenig-lineare-regression_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Wir können die Graphik im wesendlichen auch einfacher über den Befehl</p>
<pre class="r"><code>xyplot(residuals(linMod) ~ fitted(linMod))</code></pre>
<p><img src="/nab/post/2018-01-08-nur-ein-wenig-lineare-regression_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>erhalten.</p>
<p>Betrachten wir kurz nur die Rediduen:</p>
<pre class="r"><code>favstats(~residuals(linMod))</code></pre>
<pre><code>##        min         Q1      median        Q3      max          mean
##  -3.198225 -0.5651615 -0.09744499 0.4863111 3.743435 -2.022281e-17
##        sd   n missing
##  1.019943 244       0</code></pre>
<p>Wir sehe, dass wir in der Zusammenfassung immer genau diese Werte unter dem Abschnitt <em>Residuals</em> gefunden haben. Minimum, das 1. Quantil, der Median, das 3. Quantil und das Maximum stimmen überein.</p>
<p>Der erwartungstreue und unverzerrte Schätzer für den Standardfehler der Residuen, lautet</p>
<p><span class="math display">\[
\begin{align*}
    SE_{\text{Residuen}} &amp;= \sqrt{\frac{1}{n-2} \cdot \sum_{i=1}^n (\hat{e_i})^2} = \sqrt{\frac{n-1}{n-2} \cdot \frac{1}{n-1} \cdot \sum_{i=1}^n (\hat{e_i})^2} \\
                         &amp;= \sqrt{\frac{n-1}{n-2}} \cdot \sqrt{\frac{1}{n-1} \cdot \sum_{i=1}^n (\hat{e_i})^2} \\
                         &amp;= \sqrt{\frac{n-1}{n-2}} \cdot s_{\text{Residuen}}
\end{align*}
\]</span></p>
<p>Also finden wir den Wert <em>Residual standard error</em> aus der Zeile</p>
<pre><code>## Residual standard error: 1.022 on 242 degrees of freedom</code></pre>
<p>in dem wir den in den <em>favstats</em> gefundenen Wert für die Standardabweichung entsprechen korrigieren:</p>
<p><span class="math display">\[
    SE_{\text{Residuen}} = \sqrt{\frac{n-1}{n-2}} \cdot s_{\text{Residuen}} = \sqrt{\frac{243}{242}} \cdot 1.0199426 = 1.0220477
\]</span></p>
<p>Der Median der Residuen ist nicht gleich Null, wie der Mittelwert. (Welcher auch hier als numerisch Null interpretiert werden muss!) Es könnte also eine linkssteile, rechtsschiefe Verteilung der Resiuden vorliegen. Betrachten wir dazu das Histogramm:</p>
<pre class="r"><code>histogram(~residuals(linMod), nint = 19)</code></pre>
<p><img src="/nab/post/2018-01-08-nur-ein-wenig-lineare-regression_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Schon beim ersten Blick auf das Histogramm kann an eine Normalverteilung der Residuen nicht mehr so ganz geglaubt werden.</p>
<p>Ein Shapiro-Wilk-Test<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> hat als Nullhypothese die Annahme, dass die Daten normalverteilt sind!</p>
<pre class="r"><code>shapiro.test(residuals(linMod))</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(linMod)
## W = 0.96728, p-value = 2.171e-05</code></pre>
<p>Davon ist nach dem Ergebnis eben sowenig auszugehen, wie nach einem Blick auf das QQ-Normal-Diagram:</p>
<pre class="r"><code>qqnorm(residuals(linMod), col = &quot;darkgreen&quot;)</code></pre>
<p><img src="/nab/post/2018-01-08-nur-ein-wenig-lineare-regression_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Ein K.O.-Kriterium für gute Prognosen.</p>
<p>Wie gut aber beschreibt unsere Regressionsgerade die Daten?</p>
<p>Als Maß dafür können wir das Bestimmtheitsmaß nehmen.</p>
<p>Ein kurzer Blick auf die Situation, der Mittelwert der Trinkgelder ist</p>
<p><span class="math display">\[
    \bar{y} =  \frac{1}{n} \sum_{i=1}^n y_i = 2.9982787.
\]</span></p>
<p>Wir erhalten so folgendes Diagramm:</p>
<pre class="r"><code>library(lattice)
mypanel &lt;- function(x, y) {
    panel.xyplot(x, y)
    panel.abline(h = mean(y), lwd = 1.2, lty = 2, col = &quot;darkgreen&quot;)
    panel.lmline(x, y, col = &quot;red&quot;, lwd = 1.2, lty = 2)
}
xyplot(tip ~ total_bill, data = tips, panel = mypanel, main = &quot;Streudiagramm der Trinkgelder&quot;, 
    ylab = &quot;Trinkgeld&quot;, xlab = &quot;Rechnungsbetrag&quot;, key = list(space = &quot;bottom&quot;, 
        padding.text = 8, columns = 2, just = c(&quot;center&quot;, &quot;bottom&quot;), 
        lines = list(col = c(&quot;darkgreen&quot;, &quot;red&quot;), lty = c(2, 
            2), lwd = 1.2), text = list(c(&quot;Mittelwert Trinkgelder&quot;, 
            &quot; Regressionsgerade&quot;))))</code></pre>
<p><img src="/nab/post/2018-01-08-nur-ein-wenig-lineare-regression_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Die Varianz <span class="math inline">\(s^2_{y_i}=1.9144546\)</span> beschreibt die mittlere quadratische Abweichung der Datenpunkte <span class="math inline">\(y_i\)</span> vom Mittelwert <span class="math inline">\(\bar{y}\)</span>. Diese Varianz läßt sich nun Zerlegen in einen Anteil der durch die Regressionsgerade <em>erklärt</em> wird und in einen Anteil, der durch die Regressionsgerade nicht erklärt wird.</p>
<p><span class="math display">\[
    s^2_{y_i} = s^2_{\hat{y}_i} + s^2_{\hat{e}_i}
\]</span> Dividiert man beider Seiten durch die Varianz <span class="math inline">\(s^2_{y_i}\)</span>, so normiert man den Ausdruck und kann den Faktor <span class="math inline">\(\frac{1}{n-1}\)</span> (bzw. <span class="math inline">\(\frac{1}{n}\)</span>) herauskürzen. Es bleibt dann:</p>
<p><span class="math display">\[
    1 = \frac{\sum_{i=1}^n (\bar{y}- \hat{y_i})^2}{\sum_{i=1}^n (\bar{y}-y_i)^2} + \frac{\sum_{i=1}^n (\hat{e_i})^2}{\sum_{i=1}^n (\bar{y}-y_i)^2}
\]</span></p>
<p>Multipliziert man nun beide Seiten mit <span class="math inline">\(\sum_{i=1}^n (y_i)^2\)</span>, so erhält man:</p>
<p><span class="math display">\[
    \sum_{i=1}^n (\bar{y}- y_i)^2 = \sum_{i=1}^n (\bar{y}- \hat{y_i})^2+ \sum_{i=1}^n (\hat{e_i})^2 
\]</span></p>
<p>Zur vereinfachung nennt man nun die einzelnen Summen in dem ausdruck wie folgt:</p>
<ul>
<li>Der erste Ausdruck heißt <strong>Gesamtvarianz* oder </strong>total sum of squares** oder kurz <strong><span class="math inline">\(SS_T\)</span></strong>, (oder <strong>TSS</strong>) er ist die Summe der quadrierten Differenzen</li>
</ul>
<p><span class="math display">\[
    SS_T = \sum_{i=1}^n (\bar{y}-y_i)^2
\]</span></p>
<ul>
<li>Der zweite Ausdruck heißt <strong>Modellvarianz</strong> oder <strong>model sum of squares</strong> oder kurz <strong><span class="math inline">\(SS_M\)</span></strong> (oder <strong>RSS</strong>), er ist die Summe der quadrierten Differenzen aus dem Mittelwert <span class="math inline">\(\bar{y}\)</span> und der Punkte auf der Regressionsgeraden <span class="math inline">\(\hat{y}_i\)</span>:</li>
</ul>
<p><span class="math display">\[
    SS_M = \sum_{i=1}^n (\bar{y}-\hat{y}_i)^2
\]</span></p>
<ul>
<li>Der dritte Ausdruck heißt <strong>Gesamt-Verhersage-Fehler</strong>, <strong>Fehlersteuung der Regression</strong> oder <strong>error sum of squares</strong> oder kurz <span class="math inline">\(SS_E\)</span> (oder <strong>ESS</strong>), er ist die Summe der quadratischen Differenz aus den Datenpunkten <span class="math inline">\(y_i\)</span> und den Punkten der Regressionsgeraden <span class="math inline">\(\hat{y}_i\)</span>:</li>
</ul>
<p><span class="math display">\[
    SS_E = \sum_{i=1}^n (\hat{y}_i-y_i)^2 = \sum_{i=1}^n (\hat{e}_i)^2
\]</span></p>
<p>Wir können daher auch kurz</p>
<p><span class="math display">\[
    SS_T = SS_M + SS_E
\]</span> schreiben und sparen uns die ganzen Summenzeichen.</p>
<p>Die Güte einer Regression wollen wir nun durch den Anteil der durch das Model erklärten Varianz (also der <span class="math inline">\(SS_M\)</span>) ausdrücken und stellen daher nach <span class="math inline">\(SS_M\)</span> um:</p>
<p><span class="math display">\[
    SS_M = SS_T - SS_E
\]</span> Teilen wir beide Seiten durch <span class="math inline">\(SS_T\)</span> also der maximalen (weil totalen) Quadratsumme, so erhalten wir: <span class="math display">\[
    \frac{SS_M}{SS_T} = \frac{SS_T}{SS_T} - \frac{SS_E}{SS_T} = 1 - \frac{SS_E}{SS_T}
\]</span></p>
<p>Den Ausdruck <span class="math inline">\(\frac{SS_M}{SS_T}\)</span> nennen wir <strong>Bestimmtheitsmaß</strong> (<span class="math inline">\(R^2\)</span>). Es ist ein Wert zwischen 0 und 1, der den Anteil der durch das Modell beschriebenen Varianz in bezug auf die gesamt Varianz angibt.</p>
<p>In unserer Zusammenfassung des linearen Models findet sich dieser Wert auch. Und zwar unter dem Begriff:</p>
<pre><code>## Multiple R-squared:  0.4566, </code></pre>
<p>Es gilt ja:</p>
<p><span class="math display">\[
    R^2 = 1 - \frac{SS_E}{SS_T} = 1 - \frac{s^2_{\hat{e}_i}}{s^2_{y_i}} = 1 - \frac{1.0402829}{1.9144546} = 0.4566166
\]</span></p>
<p>Der Wert</p>
<pre><code>## ..., Adjusted R-squared:  0.4544</code></pre>
<p>erklärt sich nun daraus<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>, dass das Bestimmheitsmaß um so größer wird, je größer die Zahl der unabhöngigen Variablen wird. Und zwar <em>unabhöngig</em> davon, ob weitere unabhängige Variablen wirklich einen Beitrag zur Erklärungskraft liefern. Daher nutzt man besser das <strong>korrigierte Bestimmtheitsmaß</strong> (engl: <em>adjusted R-squared</em>) <span class="math inline">\(\bar{R}^2\)</span>: <span class="math display">\[
    \begin{align*}
        \bar{R}^2 &amp;= 1- (1-R^2) \cdot \frac{n-1}{n-p-1}\\ 
                  &amp;= R^2 - (1-R^2)  \cdot \frac{p}{n-p-1}
    \end{align*}
\]</span></p>
<p>Wobei <span class="math inline">\(p\)</span> die Anzahl der unabhängigen Variablen im Modell darstellt. In unsereem Beispiel gilt daher:</p>
<p><span class="math display">\[
    \begin{align*}
        \bar{R}^2 &amp;= 1 - (1-R^2)  \cdot \frac{n-1}{n-p-1} \\
                  &amp;= 1 - (1- 0.4566166)  \cdot \frac{244-1}{244- 1- 1} \\
                  &amp;= 0.4543712
    \end{align*}
\]</span></p>
<p><strong>Vorsicht:</strong> Das <em>korrigierte Bestimmtheitsmaß</em> ist nicht mehr an das Intervall <span class="math inline">\([0; 1]\)</span> gebunden! Es kann negative Werte annehmen, ist in der Regel kleiner als das (unkorrigierte) Bestimmtheitsmaß und erreicht die obere Grenze (<span class="math inline">\(\bar{R}^2=1\)</span>) genau dann, wenn <span class="math inline">\(R^2 = 1\)</span> ist.</p>
<p>Bei der <strong>Gesamtsignifikanz des Modells</strong> (auch <strong>Overall-F-Test</strong> genannt) wird geprüft, ob mindestens eine Variable einen Erklärungsgehalt für das Modell liefert.</p>
<p>Falls diese Hypothese verworfen wird ist somit das Modell nutzlos. Dieser Test lässt sich so interpretieren als würde man die gesamte Güte des Modells, also das <span class="math inline">\(R^2\)</span> des Modells, testen. Aus diesem Grund wird der F-Test der Gesamtsignifikanz des Modells auch als Anpassungsgüte-Test bezeichnet. Die Nullhypothese des F-Test der Gesamtsignifikanz des Modells sagt aus, dass alle erklärenden Variablen keinen Einfluss auf die abhängige Variable haben. Sowohl die abhängige Variable als auch die unabhängigen Variablen können binär (kategoriell) oder metrisch sein. Der <em>Wald-Test</em> kann dann die Hypothesen testen (ohne Einbezug des Achsenabschnittes):</p>
<p><span class="math display">\[
    H_{0}\colon \beta _{1}=\beta _{2}=\ldots =\beta _{k}\;=\;0\Rightarrow R^{2}=0
\]</span> gegen</p>
<p><span class="math display">\[
    H_{1}:\beta _{j}\;\neq \;0\;\mathrm {f{\ddot {u}}r\;mindestens\;ein} \;j\in \{1,\ldots ,k\}\Rightarrow R^{2}\neq 0
\]</span></p>
<p>Die Teststatistik dieses Tests lautet</p>
<p><span class="math display">\[
\begin{aligned}
    F\;\;{\stackrel {H_{0}}{=}}{\frac {R^{2}}{1-R^{2}}} \cdot {\frac {n-p-1}{p}}\;\;{\stackrel {H_{0}}{\sim }}\;\;F(p,n-p)
\end{aligned}.
\]</span></p>
<p>Die Teststatistik <span class="math inline">\(\displaystyle (n-p-1)\)</span> und <span class="math inline">\(p\)</span> Freiheitsgraden. Überschreitet der empirische F-Wert einen kritischen F-Wert, der zu einem a priori festgelegten Signifikanzniveau <span class="math inline">\(\alpha\)</span>, so verwirft man die Nullhypothese <span class="math inline">\(H_{0}\)</span>. Das <span class="math inline">\(R^{2}\)</span> ist dann ausreichend groß und mindestens ein Regressor trägt also vermutlich genügend viel Information zur Erklärung von <span class="math inline">\(y\)</span> bei. Es ist naheliegend bei hohen F-Werten die Nullhypothese zu verwerfen, da ein hohes Bestimmtheitsmaß zu einem hohen F-Wert führt. Wenn der <em>Wald-Test</em> für eine oder mehrere unabhängige Variablen die Nullhypothese ablehnt, dann kann man davon ausgehen, dass die zugehörigen Parameter ungleich Null sind, so dass die Variable(n) in das Modell mit einbezogen werden sollten.</p>
<p>In unserem Beispiel ist</p>
<p><span class="math display">\[
    {\frac {R^{2}}{1-R^{2}}} \cdot {\frac {n-p-1}{p}} = \frac{0.4566166}{1-0.4566166} \cdot \frac{244-1-1}{1} = 203.3577233
\]</span></p>
<p>der Wert in der Zeile</p>
<pre><code>## F-statistic: 203.4 on 1 and 242 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>mit Parametern <span class="math inline">\(p=1\)</span> und <span class="math inline">\(n-p-1=242\)</span> Freiheitsgraden.</p>
<p>Der p-Wert von (numerisch) 0, liefert also ein hinreichendes Indiz dafür, dass der Rechnungsbetrag einen echten Beitrag liefert.</p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>vgl: <a href="https://de.wikipedia.org/wiki/Parallelverschiebung" class="uri">https://de.wikipedia.org/wiki/Parallelverschiebung</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>vgl: <a href="https://de.wikipedia.org/wiki/Methode_der_kleinsten_Quadrate" class="uri">https://de.wikipedia.org/wiki/Methode_der_kleinsten_Quadrate</a><a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>vgl: <a href="https://de.wikipedia.org/wiki/Shapiro-Wilk-Test" class="uri">https://de.wikipedia.org/wiki/Shapiro-Wilk-Test</a><a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>vgl: <a href="https://de.wikipedia.org/wiki/Bestimmtheitsmaß#Das_korrigierte_Bestimmtheitsmaß" class="uri">https://de.wikipedia.org/wiki/Bestimmtheitsmaß#Das_korrigierte_Bestimmtheitsmaß</a><a href="#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</section>

      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/nab/tags/lehre">Lehre</a>
  
  <a class="btn btn-primary btn-outline" href="/nab/tags/r">R</a>
  
  <a class="btn btn-primary btn-outline" href="/nab/tags/statistik">Statistik</a>
  
</div>



    </div>
  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3></h3>
  <ul>
    
    <li><a href="/nab/post/quartile-quantile-perzentile-etc/">Quartile, Quantile, Perzentile etc.</a></li>
    
    <li><a href="/nab/post/prognose-konfidenz-und-fiduzialintervalle/">Prognose-, Konfidenz- und Fiduzialintervalle</a></li>
    
    <li><a href="/nab/post/konfidenzintervalle/">Konfidenzintervalle</a></li>
    
    <li><a href="/nab/post/zentrales-schwankungsintervall/">Zentrales Schwankungsintervall</a></li>
    
    <li><a href="/nab/post/10-dinge-die-kein-talent-ben%C3%B6tigen/">10 Dinge die kein Talent benötigen!</a></li>
    
  </ul>
</div>




<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "normans-akademischer-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2016-18 Norman Markgraf &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title"></h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> 
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> 
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script id="dsq-count-scr" src="//normans-akademischer-blog.disqus.com/count.js" async></script>
    

    
    <script async defer src="//maps.googleapis.com/maps/api/js?key=AIzaSyAHIzNMfWrSJMBwSMofumWsGuBIaXmNmYE"></script>
    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
    
    
    <script src="/nab/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/latex.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

